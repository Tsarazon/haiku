SubDir HAIKU_TOP src system boot platform efi_arm64 arch ;

UseLibraryHeaders [ FDirName libfdt ] ;

UsePrivateHeaders [ FDirName kernel platform ] ;
UsePrivateHeaders [ FDirName kernel boot platform efi ] ;
UsePrivateHeaders [ FDirName kernel boot arch $(TARGET_KERNEL_ARCH_DIR) ] ;

local platform ;
for platform in [ MultiBootSubDirSetup efi_arm64 ] {
	on $(platform) {
		{
			local defines = _BOOT_PLATFORM_EFI_ARM64 _BOOT_FDT_SUPPORT ;
			defines = [ FDefines $(defines) ] ;
			SubDirCcFlags $(defines) ;
			SubDirC++Flags $(defines) -fno-rtti ;
		}

		local arch_src =
			crt0-efi-aarch64.S
			entry.S
			transition.S
			exceptions.S
			cache.S
			relocation_func.cpp
			arch_acpi.cpp
			arch_cache.cpp
			arch_dtb.cpp
			arch_mmu.cpp
			arch_smp.cpp
			arch_start.cpp
			arch_timer.cpp
			;

		BootMergeObject boot_platform_efi_arm64_arch.o :
			$(arch_src)
			;
	}
}